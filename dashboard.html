<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Painel de Administração da Pizzaria Moraes.">
    <title>Dashboard - Pizzaria Moraes</title>
    
    <!-- Ícone e Estilos -->
    <link rel="icon" href="img/desenho-pizza.png" type="image/png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    
    <!-- Fontes e Ícones -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Importação da fonte 'Righteous' para o logo -->
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">

    <!-- Biblioteca de Gráficos Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
    <div class="dashboard-container">
        <!-- ==================== MENU LATERAL (SIDEBAR) ==================== -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="img/Logo.png" alt="Logo Pizzaria Moraes" class="sidebar-logo">
                <h3>
                    <span class="logo-pizzaria">Pizzaria</span> <span class="logo-moraes">Moraes</span>
                </h3>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#" class="nav-link active" data-target="inicio"><i class="material-icons">dashboard</i><span>Início</span></a></li>
                    <li><a href="#" class="nav-link" data-target="cardapio"><i class="material-icons">restaurant_menu</i><span>Cardápio</span></a></li>
                    <li><a href="#" class="nav-link" data-target="personalizacoes"><i class="material-icons">tune</i><span>Personalizações</span></a></li>
                    <li><a href="#" class="nav-link" data-target="anuncios"><i class="material-icons">campaign</i><span>Anúncios</span></a></li>
                    <li><a href="#" class="nav-link" data-target="cupom"><i class="material-icons">card_giftcard</i><span>Cupom Mágico</span></a></li>
                    <li><a href="#" class="nav-link" data-target="ofertas"><i class="material-icons">local_offer</i><span>Ofertas</span></a></li>
                    <li><a href="#" class="nav-link" data-target="entrega"><i class="material-icons">local_shipping</i><span>Entrega</span></a></li>
                    <li><a href="#" class="nav-link" data-target="calendario"><i class="material-icons">calendar_today</i><span>Calendário</span></a></li>
                    <li><a href="#" class="nav-link" data-target="pedidos"><i class="material-icons">receipt_long</i><span>Pedidos</span></a></li>
                    <li><a href="#" class="nav-link" data-target="motoboy"><i class="material-icons">delivery_dining</i><span>Motoboy</span></a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="index.html" id="logout-btn" class="nav-link"><i class="material-icons">logout</i><span>Sair</span></a>
            </div>
        </aside>

        <!-- ==================== CONTEÚDO PRINCIPAL ==================== -->
        <main class="main-content">
            <header class="main-header">
                <h1 id="main-content-title">Início</h1>
                <button id="mobile-menu-toggle" class="mobile-menu-btn"><i class="material-icons">menu</i></button>
            </header>
            
            <!-- ====== Seção Início (Dashboard Overview) ====== -->
            <section id="section-inicio" class="content-section active">
                <div class="summary-grid">
                    <div class="summary-card" id="card-faturamento-dia"><i class="material-icons icon-money">paid</i><div class="summary-text"><h4>Faturamento do Dia</h4><strong id="faturamento-dia">R$ 0,00</strong></div></div>
                    <div class="summary-card" id="card-pedidos-hoje" style="cursor: pointer;" title="Ver todos os pedidos"><i class="material-icons icon-orders">shopping_cart</i><div class="summary-text"><h4>Pedidos Hoje</h4><strong id="pedidos-hoje">0</strong></div></div>
                    <div class="summary-card" id="card-faturamento-semana"><i class="material-icons icon-money">payments</i><div class="summary-text"><h4>Faturamento Semanal</h4><strong id="faturamento-semana">R$ 0,00</strong></div></div>
                    <div class="summary-card" id="card-pedidos-semana"><i class="material-icons icon-orders">event_note</i><div class="summary-text"><h4>Pedidos da Semana</h4><strong id="pedidos-semana">0</strong></div></div>
                    <div class="summary-card" id="card-total-clientes" style="cursor: pointer;" title="Gerenciar Clientes"><i class="material-icons icon-users">group</i><div class="summary-text"><h4>Total de Clientes</h4><strong id="total-clientes">0</strong></div></div>
                </div>
                <div class="charts-grid">
                    <div class="chart-container card"><h3>Faturamento Mensal (Ano Atual)</h3><canvas id="monthlyRevenueChart"></canvas></div>
                    <div class="chart-container card"><div class="chart-header"><h3>Formas de Pagamento</h3><select id="month-selector" class="form-control-sm"></select></div><canvas id="paymentMethodsChart"></canvas></div>
                </div>
            </section>

            <!-- ====== Seção Gerenciamento de Cardápio ====== -->
            <section id="section-cardapio" class="content-section">
                <div class="cardapio-management-grid">
                    <div class="product-form-container card">
                        <h2 id="form-title">Adicionar Novo Produto</h2>
                        <form id="product-form"><input type="hidden" id="product-id"><div class="form-group"><label for="product-image">URL da Imagem</label><input type="url" id="product-image" placeholder="https://exemplo.com/imagem.png" required></div><div class="form-group"><label for="product-name">Nome do Produto</label><input type="text" id="product-name" placeholder="Ex: Pizza Calabresa" required></div><div class="form-group" id="product-ingredients-group"><label for="product-ingredients">Ingredientes</label><input type="text" id="product-ingredients" placeholder="Mussarela, calabresa, cebola..."></div><div class="form-group"><label for="product-category">Categoria</label><select id="product-category" required><option value="" disabled selected>Selecione</option><option value="pizza">Pizza</option><option value="esfiha">Esfiha</option><option value="bebida">Bebida</option></select></div><div class="form-group"><label for="product-price">Valor (R$)</label><input type="number" step="0.01" id="product-price" placeholder="45.50" required></div><div class="form-actions"><button type="submit" class="btn btn-primary">Salvar</button><button type="button" id="clear-form-btn" class="btn btn-secondary">Cancelar</button></div></form>
                    </div>
                    <div class="product-list-container card">
                        <div class="list-header"><h2>Meus Produtos</h2><div class="view-switcher"><button class="view-btn active" data-view="grid"><i class="material-icons">grid_view</i> Grid</button><button class="view-btn" data-view="table"><i class="material-icons">table_rows</i> Planilha</button></div></div>
                        <div class="view-container active" id="grid-view-container"><div class="filter-buttons" id="grid-filters"><button class="filter-btn active" data-category="all">Todos</button><button class="filter-btn" data-category="pizza">Pizzas</button><button class="filter-btn" data-category="esfiha">Esfihas</button><button class="filter-btn" data-category="bebida">Bebidas</button></div><div id="product-list-items" class="product-grid-admin"></div></div>
                        <div class="view-container" id="table-view-container">
                            <div class="table-rotation-hint" id="table-rotation-hint"><i class="material-icons">screen_rotation</i><span>Para uma melhor visualização, vire o celular na horizontal.</span></div>
                            <div class="table-controls"><div class="search-bar-table"><input type="text" id="table-search-input" placeholder="Pesquisar por nome..."><i class="material-icons">search</i></div><div class="filter-buttons" id="table-filters"><button class="filter-btn active" data-category="all">Todos</button><button class="filter-btn" data-category="pizza">Pizzas</button><button class="filter-btn" data-category="esfiha">Esfihas</button><button class="filter-btn" data-category="bebida">Bebidas</button></div></div>
                            <div class="table-wrapper"><table class="product-table"><thead><tr><th>Nome do Produto</th><th>Categoria</th><th>Preço</th><th>Ações</th></tr></thead><tbody id="product-table-body"></tbody></table></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ====== Seção Gerenciamento de Personalizações ====== -->
            <section id="section-personalizacoes" class="content-section">
                <div class="cardapio-management-grid">
                    <div class="product-form-container card">
                        <h2 id="personalizacao-form-title">Adicionar Nova Opção</h2>
                        <form id="personalizacao-form"><input type="hidden" id="personalizacao-id"><div class="form-group"><label for="personalizacao-name">Nome da Opção</label><input type="text" id="personalizacao-name" placeholder="Ex: Borda com Catupiry" required></div><div class="form-group"><label for="personalizacao-price">Valor Adicional (R$)</label><input type="number" step="0.01" id="personalizacao-price" placeholder="8.00 (deixe 0 se for grátis)" required></div><div class="form-group"><label>Aplicar Globalmente (Opcional)</label><div class="checkbox-group"><label class="checkbox-label-inline"><input type="checkbox" id="aplicar-todas-pizzas"> Todas as Pizzas</label><label class="checkbox-label-inline"><input type="checkbox" id="aplicar-todas-esfihas"> Todas as Esfihas</label><label class="checkbox-label-inline"><input type="checkbox" id="aplicar-todos-produtos"> Todos (Pizzas e Esfihas)</label></div></div><div class="form-actions"><button type="submit" class="btn btn-primary">Salvar Opção</button><button type="button" id="clear-personalizacao-form-btn" class="btn btn-secondary">Cancelar</button></div></form>
                    </div>
                    <div class="product-list-container">
                        <div class="list-header"><h2>Minhas Opções</h2></div>
                        <div id="personalizacoes-list" class="table-wrapper"><table class="product-table"><thead><tr><th>Nome</th><th>Preço</th><th>Aplicações</th><th>Ações</th></tr></thead><tbody id="personalizacoes-table-body"></tbody></table></div>
                    </div>
                </div>
            </section>
            
            <!-- ====== Seção Gerenciamento de Anúncios ====== -->
            <section id="section-anuncios" class="content-section">
                <div class="cardapio-management-grid">
                    <div class="product-form-container card">
                        <h2 id="banner-form-title">Adicionar Anúncio</h2>
                        <form id="banner-form"><input type="hidden" id="banner-id"><div class="form-group"><label for="banner-media-url">URL da Mídia (Imagem ou Vídeo)</label><input type="url" id="banner-media-url" placeholder="https://exemplo.com/imagem.png" required><small class="form-hint">Ideal: Proporção 16:7 (ex: 1280x560px)</small></div><div class="form-group"><label for="banner-link-url">Link de Redirecionamento (Opcional)</label><input type="url" id="banner-link-url" placeholder="Deixe em branco se não houver link"></div><div class="form-group"><label for="banner-media-type">Tipo de Mídia</label><select id="banner-media-type" required><option value="image" selected>Imagem</option><option value="video">Vídeo</option></select></div><div class="form-actions"><button type="submit" class="btn btn-primary">Salvar Anúncio</button><button type="button" id="clear-banner-form-btn" class="btn btn-secondary">Cancelar</button></div></form>
                    </div>
                    <div class="product-list-container"><div class="list-header"><h2>Anúncios Ativos</h2></div><div id="banner-list" class="banner-list-admin"><p>Carregando anúncios...</p></div></div>
                </div>
            </section>

            <!-- ====== Seção Gerenciamento do Cupom Mágico ====== -->
            <section id="section-cupom" class="content-section">
                <div class="cardapio-management-grid">
                    <div class="product-form-container card">
                        <h2 id="cupom-form-title">Criar Campanha de Cupom</h2>
                        <form id="cupom-campaign-form"><input type="hidden" id="campaign-id"><div class="form-group"><label for="campaign-name">Nome da Campanha</label><input type="text" id="campaign-name" placeholder="Ex: Jogo da Memória Premiado" required></div><div class="form-group"><label for="campaign-description">Descrição (para o cliente)</label><input type="text" id="campaign-description" placeholder="Ex: Encontre os pares e ganhe um super desconto!" required></div><div class="form-group"><label for="campaign-discount">Desconto do Cupom (%)</label><input type="number" id="campaign-discount" min="1" max="100" placeholder="15" required></div><div class="address-row"><div class="form-group"><label for="campaign-startDate">Data de Início</label><input type="date" id="campaign-startDate" required></div><div class="form-group"><label for="campaign-endDate">Data de Fim</label><input type="date" id="campaign-endDate" required></div></div><div class="address-row"><div class="form-group"><label for="campaign-attempts">Tentativas por Usuário</label><input type="number" id="campaign-attempts" min="1" value="1" required></div><div class="form-group"><label for="campaign-chances">Chances por Tentativa</label><input type="number" id="campaign-chances" min="2" value="18" required></div></div><div class="form-group"><label for="campaign-status">Status da Campanha</label><select id="campaign-status" required><option value="true" selected>Ativa</option><option value="false">Inativa</option></select></div><div class="form-actions"><button type="submit" class="btn btn-primary">Salvar Campanha</button><button type="button" id="clear-campaign-form-btn" class="btn btn-secondary">Cancelar</button></div></form>
                    </div>
                    <div class="product-list-container"><div class="list-header"><h2>Minhas Campanhas</h2></div><div class="table-wrapper"><table class="product-table"><thead><tr><th>Campanha</th><th>Período</th><th>Regras</th><th>Status</th><th>Ações</th></tr></thead><tbody id="campaigns-table-body"></tbody></table></div></div>
                </div>
            </section>

            <!-- ====== Seção Gerenciamento de Ofertas ====== -->
            <section id="section-ofertas" class="content-section">
                <div class="cardapio-management-grid">
                    <div class="product-form-container card">
                        <h2 id="oferta-form-title">Criar Nova Oferta/Combo</h2>
                        <form id="oferta-form">
                            <input type="hidden" id="oferta-id">
                            <div class="form-group"><label for="oferta-name">Nome da Oferta</label><input type="text" id="oferta-name" placeholder="Ex: Combo Família" required></div>
                            <div class="form-group"><label for="oferta-description">Descrição Curta</label><textarea id="oferta-description" placeholder="Ex: 2 Pizzas Grandes + 1 Refri 2L" rows="3" required></textarea></div>
                            <div class="form-group"><label for="oferta-image">URL da Imagem da Oferta</label><input type="url" id="oferta-image" placeholder="https://exemplo.com/combo.png" required></div>
                            <div class="form-group">
                                <label>Produtos do Combo</label>
                                <div class="product-selection-container">
                                    <div class="product-column">
                                        <h4>Disponíveis <span id="available-count">(0)</span></h4>
                                        <input type="text" id="oferta-products-search" placeholder="Pesquisar..." class="form-control-sm">
                                        <div id="available-products-list" class="product-drag-list"></div>
                                    </div>
                                    <div class="product-column">
                                        <h4>Selecionados <span id="selected-count">(0)</span></h4>
                                        <div id="selected-products-list" class="product-drag-list"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="address-row"><div class="form-group"><label for="oferta-price">Preço da Oferta (R$)</label><input type="number" step="0.01" id="oferta-price" placeholder="79.90" required></div><div class="form-group"><label for="oferta-expiration">Expira em (Data e Hora)</label><input type="datetime-local" id="oferta-expiration" required></div></div>
                            <div class="form-group"><label for="oferta-status">Status da Oferta</label><select id="oferta-status" required><option value="true" selected>Ativa</option><option value="false">Inativa</option></select></div>
                            <div class="form-actions"><button type="submit" class="btn btn-primary">Salvar Oferta</button><button type="button" id="clear-oferta-form-btn" class="btn btn-secondary">Cancelar</button></div>
                        </form>
                    </div>
                    <div class="product-list-container">
                        <div class="list-header"><h2>Minhas Ofertas</h2></div>
                        <div class="table-wrapper"><table class="product-table"><thead><tr><th>Oferta</th><th>Preço</th><th>Expira em</th><th>Status</th><th>Ações</th></tr></thead><tbody id="ofertas-table-body"></tbody></table></div>
                    </div>
                </div>
            </section>

            <!-- ====== Seção Configuração de Entrega ====== -->
            <section id="section-entrega" class="content-section">
                <div class="delivery-config-grid">
                    <form id="delivery-settings-form" class="card">
                        <h2>Configurações de Entrega</h2>
                        <div class="form-group"><label for="delivery-fee">Taxa de Entrega Padrão (R$)</label><input type="number" step="0.01" id="delivery-fee" placeholder="Ex: 5.00" required></div>
                        <div class="form-group"><label for="free-delivery-distance">Distância Isenta de Taxa (em metros)</label><input type="number" id="free-delivery-distance" placeholder="Ex: 800" required><small class="form-hint">Pedidos dentro desta distância terão frete grátis.</small></div>
                        <button type="submit" class="btn btn-primary">Salvar Configurações</button>
                    </form>
                    <form id="pizzeria-address-form" class="card">
                        <h2>Endereço da Pizzaria</h2>
                        <div class="form-group"><label for="pizzeria-cep">CEP</label><input type="tel" id="pizzeria-cep" placeholder="00000-000" required></div>
                        <div class="form-group"><label for="pizzeria-rua">Rua / Logradouro</label><input type="text" id="pizzeria-rua" placeholder="Av. Paulista" required></div>
                        <div class="form-group"><label for="pizzeria-numero">Número</label><input type="text" id="pizzeria-numero" placeholder="1000" required></div>
                        <div id="geocode-status" class="geocode-status-message"></div>
                        <button type="submit" class="btn btn-primary">Salvar Endereço</button>
                    </form>
                </div>
            </section>

            <!-- ====== Seção Calendário ====== -->
            <section id="section-calendario" class="content-section">
                <div class="calendar-view-container">
                    <div class="calendar-container card"><div class="calendar-header"><button id="prev-month-btn" class="calendar-nav-btn"><i class="material-icons">chevron_left</i></button><h2 id="month-year-display">Carregando...</h2><button id="next-month-btn" class="calendar-nav-btn"><i class="material-icons">chevron_right</i></button></div><div class="calendar-weekdays"><div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div></div><div id="calendar-days-grid" class="calendar-days"></div></div>
                    <div id="calendar-info-panel" class="card"><h3>Resumo do Dia</h3><p id="selected-date-info">Selecione um dia no calendário.</p><div id="daily-stats" style="display: none;"><div class="stat-item"><span>Total de Pedidos</span><strong id="pizzas-sold-count">0</strong></div><div class="stat-item"><span>Faturamento Total</span><strong id="daily-revenue">R$ 0,00</strong></div></div></div>
                </div>
            </section>

            <!-- ====== Seção Pedidos ====== -->
            <section id="section-pedidos" class="content-section">
                <div class="list-header"><h2>Histórico de Pedidos</h2><div class="filter-buttons" id="pedidos-filter-buttons"><button class="filter-btn active" data-status="todos">Todos</button><button class="filter-btn" data-status="Pagamento Pendente">Pendentes</button><button class="filter-btn" data-status="Concluído">Concluídos</button><button class="filter-btn" data-status="Cancelado">Cancelados</button></div></div>
                <div id="all-orders-list" class="card"><p>Carregando histórico de pedidos...</p></div>
            </section>
            
            <!-- ====== Seção Motoboy ====== -->
            <section id="section-motoboy" class="content-section">
                <div class="list-header"><h2>Entregas do Dia</h2><div class="filter-buttons" id="motoboy-filter-buttons"><button class="filter-btn active" data-status="pendente">Pendentes</button><button class="filter-btn" data-status="feita">Feitas</button></div></div>
                <div id="motoboy-orders-grid" class="motoboy-grid"><p>Buscando pedidos prontos para entrega...</p></div>
            </section>

            <!-- Modal de Gerenciamento de Clientes -->
            <div class="modal-overlay" id="clients-modal-overlay">
                <div class="modal-content large" id="clients-modal-content">
                    <button class="close-modal-btn" id="close-clients-modal-btn" aria-label="Fechar">&times;</button>
                    <div id="clients-list-container"><h2>Gerenciar Clientes</h2><div id="clients-list" class="clients-list-wrapper"><p>Carregando clientes...</p></div></div>
                    <div id="client-edit-form-container" style="display: none;">
                        <h3>Editar Cliente</h3>
                        <form id="client-edit-form"><input type="hidden" id="edit-client-id"><div class="form-group"><label for="edit-nome">Nome Completo</label><input type="text" id="edit-nome" required></div><div class="form-group"><label for="edit-email">Email (não pode ser alterado)</label><input type="email" id="edit-email" readonly disabled></div><div class="form-group"><label for="edit-telefone">Telefone</label><input type="tel" id="edit-telefone" required></div><div class="form-group"><label for="edit-cpf">CPF</label><input type="text" id="edit-cpf" required></div><div class="form-group"><label for="edit-nascimento">Data de Nascimento</label><input type="date" id="edit-nascimento" required></div><div class="form-actions"><button type="submit" class="btn btn-primary">Salvar Alterações</button><button type="button" id="cancel-edit-btn" class="btn btn-secondary">Cancelar</button></div></form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para o Pop-up de Rotas -->
    <div class="modal-overlay" id="maps-modal-overlay">
        <div class="modal-content">
            <button class="close-modal-btn" id="close-maps-modal-btn" aria-label="Fechar">&times;</button>
            <h2>Abrir Rota</h2>
            <p id="maps-modal-address">Carregando endereço...</p>
            <div class="maps-links">
                <a href="#" id="google-maps-link" target="_blank" class="map-link google"><img src="https://upload.wikimedia.org/wikipedia/commons/a/aa/Google_Maps_icon_(2020).svg" alt="Google Maps"><span>Google Maps</span></a>
                <a href="#" id="waze-link" target="_blank" class="map-link waze"><img src="https://cdn-1.webcatalog.io/catalog/waze/waze-icon-256.png" alt="Waze"><span>Waze</span></a>
            </div>
        </div>
    </div>

    <script type="module" src="js/dashboard.js"></script>

    <div id="persistent-notification-bar" class="notification-bar">
        <div class="notification-icon"><i class="material-icons">shopping_cart_checkout</i></div>
        <div class="notification-content"><h4>Novo Pedido!</h4><p id="notification-message">Um novo pedido acabou de chegar.</p></div>
        <div class="notification-actions"><button id="view-order-btn" class="btn btn-sm btn-primary">Ver Pedidos</button><button id="notification-close-btn" class="notification-close" title="Dispensar">&times;</button></div>
    </div>
    <audio id="notification-sound" src="https://assets.codepen.io/296057/plink.mp3" preload="auto"></audio>
</body>
</html>